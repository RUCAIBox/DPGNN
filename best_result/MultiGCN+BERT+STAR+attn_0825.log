Wed 25 Aug 2021 07:36:12 INFO Parameters:
	model=MultiPJF
	use_gpu=True
	gpu_id=0
	learner=Adam
	epochs=3000
	eval_step=1
	stopping_step=5
	clip_grad_norm=None
	pos_weight=8.633
	topk=[5]
	valid_metric=gauc
	num_workers=4
	pin_memory=True
	checkpoint_dir=./saved/
	dataset_path=/home/yangchen/dataset/job/cikm/final_dir
	loss_decimal_place=4
	metric_decimal_place=4
	seed=2020
	reproducibility=True
	embedding_size=256
	GCN_layers=3
	BERT_embedding_size=768
	BERT_output_size=32
	ADD_BIAS=True
	ADD_BERT=True
	ADD_STAR=True
	sample_n=3
	learning_rate=0.0001
	train_batch_size=4096
	eval_batch_size=4096
	name=None
	direction=multi
	dropout=0.2
	n_layers=2
	device=cuda
Wed 25 Aug 2021 07:36:12 INFO Loading /home/yangchen/dataset/job/cikm/final_dir/geek.token
Wed 25 Aug 2021 07:36:12 INFO Loading /home/yangchen/dataset/job/cikm/final_dir/job.token
Wed 25 Aug 2021 07:36:13 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/geek.bert.npy
Wed 25 Aug 2021 07:36:13 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/job.bert.npy
Wed 25 Aug 2021 07:36:58 INFO Pool:
	55494 geeks
	41719 jobs
Wed 25 Aug 2021 07:36:58 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.train_all
Wed 25 Aug 2021 07:37:00 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.train_all.bert.npy
Wed 25 Aug 2021 07:37:08 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.valid_g
Wed 25 Aug 2021 07:37:09 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.valid_g.bert.npy
Wed 25 Aug 2021 07:37:10 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.test_g
Wed 25 Aug 2021 07:37:11 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.test_g.bert.npy
Wed 25 Aug 2021 07:37:12 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.test_g
Wed 25 Aug 2021 07:37:13 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.test_g.bert.npy
Wed 25 Aug 2021 07:37:14 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.test_j
Wed 25 Aug 2021 07:37:14 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.test_j.bert.npy
Wed 25 Aug 2021 07:37:15 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.train_g
Wed 25 Aug 2021 07:37:16 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.train_g.bert.npy
Wed 25 Aug 2021 07:37:20 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.train_j
Wed 25 Aug 2021 07:37:22 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.train_j.bert.npy
Wed 25 Aug 2021 07:37:25 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.user_add
Wed 25 Aug 2021 07:37:27 INFO Loading from /home/yangchen/dataset/job/cikm/final_dir/data.job_add
Wed 25 Aug 2021 07:37:28 INFO train_all Dataset:
	1792324 interactions
Wed 25 Aug 2021 07:37:28 INFO valid_g Dataset:
	346256 interactions
Wed 25 Aug 2021 07:37:28 INFO test_g Dataset:
	323658 interactions
Wed 25 Aug 2021 07:37:28 INFO test_g Dataset:
	323658 interactions
Wed 25 Aug 2021 07:37:28 INFO test_j Dataset:
	158254 interactions
Wed 25 Aug 2021 07:37:28 INFO train_g Dataset:
	969675 interactions
Wed 25 Aug 2021 07:37:28 INFO train_j Dataset:
	822649 interactions
Wed 25 Aug 2021 07:37:28 INFO user_add Dataset:
	1767584 interactions
Wed 25 Aug 2021 07:37:28 INFO job_add Dataset:
	342216 interactions
Wed 25 Aug 2021 07:38:06 INFO MultiPJF(
  (user_embedding_c): Embedding(55494, 256)
  (item_embedding_c): Embedding(41719, 256)
  (user_embedding_p): Embedding(55494, 256)
  (item_embedding_p): Embedding(41719, 256)
  (gcn_layers): Sequential(
    (0): GCNConv()
    (1): GCNConv()
    (2): GCNConv()
  )
  (bert_lr): Linear(in_features=768, out_features=32, bias=True)
  (mlp): Sequential(
    (0): Linear(in_features=1728, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Sigmoid()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=64, out_features=1, bias=True)
  )
  (job_c_attn): Linear(in_features=288, out_features=1, bias=True)
  (job_p_attn): Linear(in_features=288, out_features=1, bias=True)
  (geek_c_attn): Linear(in_features=288, out_features=1, bias=True)
  (geek_p_attn): Linear(in_features=288, out_features=1, bias=True)
  (geek_b): Embedding(55494, 1)
  (job_b): Embedding(41719, 1)
  (sigmoid): Sigmoid()
  (loss): BCEWithLogitsLoss()
)
	Trainable parameters: 50006883
Wed 25 Aug 2021 07:41:15 INFO epoch 0 training [time: 189.40s, train loss:606.7123]
Wed 25 Aug 2021 07:41:50 INFO epoch 0 evaluating [time: 34.35s, valid_score: 0.650300]
Wed 25 Aug 2021 07:41:50 INFO valid result:
	gauc:	0.6503
	p@5:	0.2053
	r@5:	0.6150
	mrr:	0.4625
Wed 25 Aug 2021 07:41:52 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 07:44:58 INFO epoch 1 training [time: 185.85s, train loss:357.7468]
Wed 25 Aug 2021 07:45:32 INFO epoch 1 evaluating [time: 33.94s, valid_score: 0.715600]
Wed 25 Aug 2021 07:45:32 INFO valid result:
	gauc:	0.7156
	p@5:	0.2221
	r@5:	0.6772
	mrr:	0.5229
Wed 25 Aug 2021 07:45:35 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 07:48:41 INFO epoch 2 training [time: 186.80s, train loss:150.4803]
Wed 25 Aug 2021 07:49:15 INFO epoch 2 evaluating [time: 33.76s, valid_score: 0.725500]
Wed 25 Aug 2021 07:49:15 INFO valid result:
	gauc:	0.7255
	p@5:	0.2241
	r@5:	0.6840
	mrr:	0.5299
Wed 25 Aug 2021 07:49:18 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 07:52:25 INFO epoch 3 training [time: 186.87s, train loss:71.0851]
Wed 25 Aug 2021 07:52:58 INFO epoch 3 evaluating [time: 33.25s, valid_score: 0.729600]
Wed 25 Aug 2021 07:52:58 INFO valid result:
	gauc:	0.7296
	p@5:	0.2264
	r@5:	0.6926
	mrr:	0.5336
Wed 25 Aug 2021 07:53:01 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 07:56:08 INFO epoch 4 training [time: 186.91s, train loss:38.4243]
Wed 25 Aug 2021 07:56:41 INFO epoch 4 evaluating [time: 33.15s, valid_score: 0.730900]
Wed 25 Aug 2021 07:56:41 INFO valid result:
	gauc:	0.7309
	p@5:	0.2266
	r@5:	0.6939
	mrr:	0.5328
Wed 25 Aug 2021 07:56:43 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 07:59:50 INFO epoch 5 training [time: 186.79s, train loss:22.8770]
Wed 25 Aug 2021 08:00:24 INFO epoch 5 evaluating [time: 33.72s, valid_score: 0.732800]
Wed 25 Aug 2021 08:00:24 INFO valid result:
	gauc:	0.7328
	p@5:	0.2266
	r@5:	0.6940
	mrr:	0.5328
Wed 25 Aug 2021 08:00:26 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 08:03:33 INFO epoch 6 training [time: 186.98s, train loss:14.7113]
Wed 25 Aug 2021 08:04:07 INFO epoch 6 evaluating [time: 34.08s, valid_score: 0.733500]
Wed 25 Aug 2021 08:04:07 INFO valid result:
	gauc:	0.7335
	p@5:	0.2268
	r@5:	0.6940
	mrr:	0.5330
Wed 25 Aug 2021 08:04:10 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 08:07:17 INFO epoch 7 training [time: 186.77s, train loss:10.0084]
Wed 25 Aug 2021 08:07:51 INFO epoch 7 evaluating [time: 33.97s, valid_score: 0.734100]
Wed 25 Aug 2021 08:07:51 INFO valid result:
	gauc:	0.7341
	p@5:	0.2266
	r@5:	0.6940
	mrr:	0.5333
Wed 25 Aug 2021 08:07:53 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 08:11:01 INFO epoch 8 training [time: 187.14s, train loss:7.0935]
Wed 25 Aug 2021 08:11:34 INFO epoch 8 evaluating [time: 33.44s, valid_score: 0.734600]
Wed 25 Aug 2021 08:11:34 INFO valid result:
	gauc:	0.7346
	p@5:	0.2267
	r@5:	0.6935
	mrr:	0.5341
Wed 25 Aug 2021 08:11:37 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 08:14:44 INFO epoch 9 training [time: 187.12s, train loss:5.1625]
Wed 25 Aug 2021 08:15:17 INFO epoch 9 evaluating [time: 33.34s, valid_score: 0.735400]
Wed 25 Aug 2021 08:15:17 INFO valid result:
	gauc:	0.7354
	p@5:	0.2266
	r@5:	0.6929
	mrr:	0.5346
Wed 25 Aug 2021 08:15:20 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 08:18:27 INFO epoch 10 training [time: 187.39s, train loss:3.8339]
Wed 25 Aug 2021 08:19:01 INFO epoch 10 evaluating [time: 33.90s, valid_score: 0.735800]
Wed 25 Aug 2021 08:19:01 INFO valid result:
	gauc:	0.7358
	p@5:	0.2263
	r@5:	0.6919
	mrr:	0.5343
Wed 25 Aug 2021 08:19:04 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 08:22:11 INFO epoch 11 training [time: 187.18s, train loss:2.8934]
Wed 25 Aug 2021 08:22:45 INFO epoch 11 evaluating [time: 33.69s, valid_score: 0.736000]
Wed 25 Aug 2021 08:22:45 INFO valid result:
	gauc:	0.7360
	p@5:	0.2266
	r@5:	0.6929
	mrr:	0.5336
Wed 25 Aug 2021 08:22:47 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 08:25:54 INFO epoch 12 training [time: 186.79s, train loss:2.2063]
Wed 25 Aug 2021 08:26:27 INFO epoch 12 evaluating [time: 33.40s, valid_score: 0.736000]
Wed 25 Aug 2021 08:26:27 INFO valid result:
	gauc:	0.7360
	p@5:	0.2263
	r@5:	0.6918
	mrr:	0.5347
Wed 25 Aug 2021 08:29:34 INFO epoch 13 training [time: 187.13s, train loss:1.7000]
Wed 25 Aug 2021 08:30:09 INFO epoch 13 evaluating [time: 34.54s, valid_score: 0.736000]
Wed 25 Aug 2021 08:30:09 INFO valid result:
	gauc:	0.7360
	p@5:	0.2268
	r@5:	0.6932
	mrr:	0.5343
Wed 25 Aug 2021 08:33:16 INFO epoch 14 training [time: 187.06s, train loss:1.3191]
Wed 25 Aug 2021 08:33:49 INFO epoch 14 evaluating [time: 33.14s, valid_score: 0.736500]
Wed 25 Aug 2021 08:33:49 INFO valid result:
	gauc:	0.7365
	p@5:	0.2266
	r@5:	0.6931
	mrr:	0.5344
Wed 25 Aug 2021 08:33:52 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 08:36:59 INFO epoch 15 training [time: 186.98s, train loss:1.0289]
Wed 25 Aug 2021 08:37:33 INFO epoch 15 evaluating [time: 33.74s, valid_score: 0.736600]
Wed 25 Aug 2021 08:37:33 INFO valid result:
	gauc:	0.7366
	p@5:	0.2269
	r@5:	0.6936
	mrr:	0.5342
Wed 25 Aug 2021 08:37:35 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 08:40:42 INFO epoch 16 training [time: 186.95s, train loss:0.8065]
Wed 25 Aug 2021 08:41:16 INFO epoch 16 evaluating [time: 33.78s, valid_score: 0.736400]
Wed 25 Aug 2021 08:41:16 INFO valid result:
	gauc:	0.7364
	p@5:	0.2270
	r@5:	0.6945
	mrr:	0.5328
Wed 25 Aug 2021 08:44:23 INFO epoch 17 training [time: 186.77s, train loss:0.6340]
Wed 25 Aug 2021 08:44:56 INFO epoch 17 evaluating [time: 33.28s, valid_score: 0.736100]
Wed 25 Aug 2021 08:44:56 INFO valid result:
	gauc:	0.7361
	p@5:	0.2267
	r@5:	0.6931
	mrr:	0.5333
Wed 25 Aug 2021 08:48:03 INFO epoch 18 training [time: 186.95s, train loss:0.5007]
Wed 25 Aug 2021 08:48:37 INFO epoch 18 evaluating [time: 34.04s, valid_score: 0.736200]
Wed 25 Aug 2021 08:48:37 INFO valid result:
	gauc:	0.7362
	p@5:	0.2266
	r@5:	0.6927
	mrr:	0.5336
Wed 25 Aug 2021 08:51:44 INFO epoch 19 training [time: 187.25s, train loss:0.3957]
Wed 25 Aug 2021 08:52:18 INFO epoch 19 evaluating [time: 33.51s, valid_score: 0.736500]
Wed 25 Aug 2021 08:52:18 INFO valid result:
	gauc:	0.7365
	p@5:	0.2267
	r@5:	0.6931
	mrr:	0.5332
Wed 25 Aug 2021 08:55:26 INFO epoch 20 training [time: 188.29s, train loss:0.3130]
Wed 25 Aug 2021 08:56:00 INFO epoch 20 evaluating [time: 33.65s, valid_score: 0.736700]
Wed 25 Aug 2021 08:56:00 INFO valid result:
	gauc:	0.7367
	p@5:	0.2268
	r@5:	0.6933
	mrr:	0.5343
Wed 25 Aug 2021 08:56:02 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 08:59:09 INFO epoch 21 training [time: 186.93s, train loss:0.2493]
Wed 25 Aug 2021 08:59:43 INFO epoch 21 evaluating [time: 33.66s, valid_score: 0.736500]
Wed 25 Aug 2021 08:59:43 INFO valid result:
	gauc:	0.7365
	p@5:	0.2269
	r@5:	0.6940
	mrr:	0.5345
Wed 25 Aug 2021 09:02:50 INFO epoch 22 training [time: 187.08s, train loss:0.1981]
Wed 25 Aug 2021 09:03:24 INFO epoch 22 evaluating [time: 33.63s, valid_score: 0.736800]
Wed 25 Aug 2021 09:03:24 INFO valid result:
	gauc:	0.7368
	p@5:	0.2270
	r@5:	0.6947
	mrr:	0.5344
Wed 25 Aug 2021 09:03:26 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 09:06:33 INFO epoch 23 training [time: 186.81s, train loss:0.1573]
Wed 25 Aug 2021 09:07:07 INFO epoch 23 evaluating [time: 34.00s, valid_score: 0.736900]
Wed 25 Aug 2021 09:07:07 INFO valid result:
	gauc:	0.7369
	p@5:	0.2270
	r@5:	0.6945
	mrr:	0.5340
Wed 25 Aug 2021 09:07:10 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 09:10:17 INFO epoch 24 training [time: 187.71s, train loss:0.1258]
Wed 25 Aug 2021 09:10:51 INFO epoch 24 evaluating [time: 33.90s, valid_score: 0.737000]
Wed 25 Aug 2021 09:10:51 INFO valid result:
	gauc:	0.7370
	p@5:	0.2270
	r@5:	0.6946
	mrr:	0.5348
Wed 25 Aug 2021 09:10:54 INFO Saving current best: ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 09:14:01 INFO epoch 25 training [time: 187.34s, train loss:0.1003]
Wed 25 Aug 2021 09:14:35 INFO epoch 25 evaluating [time: 34.14s, valid_score: 0.737000]
Wed 25 Aug 2021 09:14:35 INFO valid result:
	gauc:	0.7370
	p@5:	0.2271
	r@5:	0.6950
	mrr:	0.5342
Wed 25 Aug 2021 09:17:43 INFO epoch 26 training [time: 187.66s, train loss:0.0799]
Wed 25 Aug 2021 09:18:17 INFO epoch 26 evaluating [time: 34.10s, valid_score: 0.737000]
Wed 25 Aug 2021 09:18:17 INFO valid result:
	gauc:	0.7370
	p@5:	0.2270
	r@5:	0.6946
	mrr:	0.5347
Wed 25 Aug 2021 09:21:25 INFO epoch 27 training [time: 187.60s, train loss:0.0640]
Wed 25 Aug 2021 09:21:59 INFO epoch 27 evaluating [time: 34.48s, valid_score: 0.736500]
Wed 25 Aug 2021 09:21:59 INFO valid result:
	gauc:	0.7365
	p@5:	0.2268
	r@5:	0.6944
	mrr:	0.5341
Wed 25 Aug 2021 09:25:07 INFO epoch 28 training [time: 187.72s, train loss:0.0511]
Wed 25 Aug 2021 09:25:41 INFO epoch 28 evaluating [time: 34.46s, valid_score: 0.736500]
Wed 25 Aug 2021 09:25:41 INFO valid result:
	gauc:	0.7365
	p@5:	0.2271
	r@5:	0.6949
	mrr:	0.5338
Wed 25 Aug 2021 09:28:48 INFO epoch 29 training [time: 186.90s, train loss:0.0409]
Wed 25 Aug 2021 09:29:22 INFO epoch 29 evaluating [time: 33.53s, valid_score: 0.736900]
Wed 25 Aug 2021 09:29:22 INFO valid result:
	gauc:	0.7369
	p@5:	0.2270
	r@5:	0.6940
	mrr:	0.5349
Wed 25 Aug 2021 09:32:30 INFO epoch 30 training [time: 187.59s, train loss:0.0328]
Wed 25 Aug 2021 09:33:03 INFO epoch 30 evaluating [time: 33.71s, valid_score: 0.736800]
Wed 25 Aug 2021 09:33:03 INFO valid result:
	gauc:	0.7368
	p@5:	0.2269
	r@5:	0.6941
	mrr:	0.5343
Wed 25 Aug 2021 09:33:03 INFO Finished training, best eval result in epoch 24
Wed 25 Aug 2021 09:33:03 INFO best valid result: {'p@5': 0.227, 'r@5': 0.6946, 'mrr': 0.5348, 'gauc': 0.737}
Wed 25 Aug 2021 09:33:04 INFO Loading model structure and parameters from ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 09:33:35 INFO test for user result [all]: 
	gauc:	0.7582
	p@5:	0.2309
	r@5:	0.6958
	mrr:	0.5450
Wed 25 Aug 2021 09:33:36 INFO Loading model structure and parameters from ./saved/MultiPJF-Aug-25-2021_07-38-06.pth
Wed 25 Aug 2021 09:33:54 INFO test for job result [all]: 
	gauc:	0.6594
	p@5:	0.3405
	r@5:	0.6677
	mrr:	0.6013
